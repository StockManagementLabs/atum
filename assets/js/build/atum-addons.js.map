{"version":3,"sources":["webpack:///atum-addons.js","webpack:///webpack/bootstrap 05a97357da1f66547210","webpack:///./assets/js/src/config/_settings.ts","webpack:///./assets/js/src/addons.ts","webpack:///./assets/js/src/components/addons-page/_addons-page.ts"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","0","__webpack_exports__","Settings","varName","defaults","this","settings","localizedOpts","window","assign","prop","getAll","delete","63","value","__WEBPACK_IMPORTED_MODULE_0__config_settings__","__WEBPACK_IMPORTED_MODULE_1__components_addons_page_addons_page__","jQuery","$","64","AddonsPage","_this","swal","$addonsList","on","evt","preventDefault","$button","currentTarget","key","siblings","val","showErrorAlert","hasClass","title","html","type","confirmButtonText","cancelButtonText","showCancelButton","then","requestLicenseChange","catch","noop","$addonBlock","closest","ajax","url","method","dataType","data","token","action","addon","slug","find","beforeSend","beforeAjax","success","response","afterAjax","showSuccessAlert","slideToggle","showLoaderOnConfirm","allowOutsideClick","preConfirm","Promise","resolve","reject","message","location","reload","css","after","remove"],"mappings":"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","file":"atum-addons.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 63);\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ 0:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar Settings = (function () {\n    function Settings(varName, defaults) {\n        if (defaults === void 0) { defaults = {}; }\n        this.varName = varName;\n        this.defaults = defaults;\n        this.settings = {};\n        var localizedOpts = typeof window[varName] !== 'undefined' ? window[varName] : {};\n        Object.assign(this.settings, defaults, localizedOpts);\n    }\n    Settings.prototype.get = function (prop) {\n        if (typeof this.settings[prop] !== 'undefined') {\n            return this.settings[prop];\n        }\n        return undefined;\n    };\n    Settings.prototype.getAll = function () {\n        return this.settings;\n    };\n    Settings.prototype.delete = function (prop) {\n        if (this.settings.hasOwnProperty(prop)) {\n            delete this.settings[prop];\n        }\n    };\n    return Settings;\n}());\n/* harmony default export */ __webpack_exports__[\"a\"] = (Settings);\n\n\n/***/ }),\n\n/***/ 63:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__config_settings__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__components_addons_page_addons_page__ = __webpack_require__(64);\nwindow['$'] = window['jQuery'];\n\n\njQuery(function ($) {\n    var settings = new __WEBPACK_IMPORTED_MODULE_0__config_settings__[\"a\" /* default */]('atumAddons');\n    new __WEBPACK_IMPORTED_MODULE_1__components_addons_page_addons_page__[\"a\" /* default */](settings);\n});\n\n\n/***/ }),\n\n/***/ 64:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar AddonsPage = (function () {\n    function AddonsPage(settings) {\n        var _this = this;\n        this.settings = settings;\n        this.swal = window['swal'];\n        this.$addonsList = $('.atum-addons');\n        this.$addonsList\n            .on('click', '.addon-key button', function (evt) {\n            evt.preventDefault();\n            var $button = $(evt.currentTarget), key = $button.siblings('input').val();\n            if (!key) {\n                _this.showErrorAlert(_this.settings.get('invalidKey'));\n                return false;\n            }\n            if ($button.hasClass('deactivate-key')) {\n                _this.swal({\n                    title: _this.settings.get('limitedDeactivations'),\n                    html: _this.settings.get('allowedDeactivations'),\n                    type: 'warning',\n                    confirmButtonText: _this.settings.get('continue'),\n                    cancelButtonText: _this.settings.get('cancel'),\n                    showCancelButton: true\n                }).then(function () {\n                    _this.requestLicenseChange($button, key);\n                })\n                    .catch(_this.swal.noop);\n            }\n            else {\n                _this.requestLicenseChange($button, key);\n            }\n        })\n            .on('click', '.install-addon', function (evt) {\n            var $button = $(evt.currentTarget), $addonBlock = $button.closest('.theme');\n            $.ajax({\n                url: window['ajaxurl'],\n                method: 'POST',\n                dataType: 'json',\n                data: {\n                    token: _this.$addonsList.data('nonce'),\n                    action: 'atum_install_addon',\n                    addon: $addonBlock.data('addon'),\n                    slug: $addonBlock.data('addon-slug'),\n                    key: $addonBlock.find('.addon-key input').val()\n                },\n                beforeSend: function () {\n                    _this.beforeAjax($button);\n                },\n                success: function (response) {\n                    _this.afterAjax($button);\n                    if (response.success === true) {\n                        _this.showSuccessAlert(response.data);\n                    }\n                    else {\n                        _this.showErrorAlert(response.data);\n                    }\n                }\n            });\n        })\n            .on('click', '.show-key', function (evt) {\n            $(evt.currentTarget).closest('.theme').find('.addon-key').slideToggle('fast');\n        });\n    }\n    AddonsPage.prototype.requestLicenseChange = function ($button, key) {\n        var _this = this;\n        $.ajax({\n            url: window['ajaxurl'],\n            method: 'POST',\n            dataType: 'json',\n            data: {\n                token: this.$addonsList.data('nonce'),\n                action: $button.data('action'),\n                addon: $button.closest('.theme').data('addon'),\n                key: key\n            },\n            beforeSend: function () {\n                _this.beforeAjax($button);\n            },\n            success: function (response) {\n                _this.afterAjax($button);\n                switch (response.success) {\n                    case false:\n                        _this.showErrorAlert(response.data);\n                        break;\n                    case true:\n                        _this.showSuccessAlert(response.data);\n                        break;\n                    case 'activate':\n                        _this.swal({\n                            title: _this.settings.get('activation'),\n                            html: response.data,\n                            type: 'info',\n                            showCancelButton: true,\n                            showLoaderOnConfirm: true,\n                            confirmButtonText: _this.settings.get('activate'),\n                            allowOutsideClick: false,\n                            preConfirm: function () {\n                                return new Promise(function (resolve, reject) {\n                                    $.ajax({\n                                        url: window['ajaxurl'],\n                                        method: 'POST',\n                                        dataType: 'json',\n                                        data: {\n                                            token: _this.$addonsList.data('nonce'),\n                                            action: 'atum_activate_license',\n                                            addon: $button.closest('.theme').data('addon'),\n                                            key: key\n                                        },\n                                        success: function (response) {\n                                            if (response.success === true) {\n                                                resolve();\n                                            }\n                                            else {\n                                                reject(response.data);\n                                            }\n                                        }\n                                    });\n                                });\n                            }\n                        }).then(function () {\n                            _this.showSuccessAlert(_this.settings.get('addonActivated'), _this.settings.get('activated'));\n                        })\n                            .catch(_this.swal.noop);\n                        break;\n                }\n            }\n        });\n    };\n    AddonsPage.prototype.showSuccessAlert = function (message, title) {\n        if (!title) {\n            title = this.settings.get('success');\n        }\n        this.swal({\n            title: title,\n            html: message,\n            type: 'success',\n            confirmButtonText: this.settings.get('ok')\n        }).then(function () {\n            location.reload();\n        });\n    };\n    AddonsPage.prototype.showErrorAlert = function (message) {\n        this.swal({\n            title: this.settings.get('error'),\n            html: message,\n            type: 'error',\n            confirmButtonText: this.settings.get('ok')\n        });\n    };\n    AddonsPage.prototype.beforeAjax = function ($button) {\n        $('.theme').find('.button').prop('disabled', true);\n        $button.css('visibility', 'hidden').after('<div class=\"atum-loading\"></div>');\n    };\n    AddonsPage.prototype.afterAjax = function ($button) {\n        $('.atum-loading').remove();\n        $('.theme').find('.button').prop('disabled', false);\n        $button.css('visibility', 'visible');\n    };\n    return AddonsPage;\n}());\n/* harmony default export */ __webpack_exports__[\"a\"] = (AddonsPage);\n\n\n/***/ })\n\n/******/ });\n\n\n// WEBPACK FOOTER //\n// atum-addons.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 63);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 05a97357da1f66547210","/* ====================\n   SETTINGS\n   ==================== */\n\n\nexport default class Settings {\n\t\n\tsettings: any = {};\n\t\n\tconstructor(\n\t\tprivate varName: string,\n\t\tprivate defaults: any = {}\n\t) {\n\t\t\n\t\tconst localizedOpts: any = typeof window[varName] !== 'undefined' ? window[varName] : {};\n\t\n\t\t// Merge all the settings.\n\t\tObject.assign( this.settings, defaults, localizedOpts );\n\t\t\n\t}\n\t\n\tget(prop: string) {\n\t\t\n\t\tif (typeof this.settings[prop] !== 'undefined') {\n\t\t\treturn this.settings[prop];\n\t\t}\n\t\t\n\t\treturn undefined;\n\t\t\n\t}\n\t\n\tgetAll() {\n\t\treturn this.settings;\n\t}\n\t\n\tdelete(prop: string) {\n\t\t\n\t\tif (this.settings.hasOwnProperty(prop)) {\n\t\t\tdelete this.settings[prop];\n\t\t}\n\t\t\n\t}\n\t\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/js/src/config/_settings.ts","/**\n * Atum Addons\n *\n * @copyright Stock Management Labs ©2019\n *\n * @since 1.2.0\n */\n\nwindow['$'] = window['jQuery'];\n\n/**\n * Components\n */\n\nimport Settings from './config/_settings';\nimport AddonsPage from './components/addons-page/_addons-page';\n\n\n// Modules that need to execute when the DOM is ready should go here.\njQuery( ($) => {\n\t\n\t// Get the options from the localized var.\n\tlet settings = new Settings('atumAddons');\n\tnew AddonsPage(settings);\n\t\n});\n\n\n// WEBPACK FOOTER //\n// ./assets/js/src/addons.ts","/* =======================================\n   ADD-ONS PAGE\n   ======================================= */\n\nimport Settings from '../../config/_settings';\n\nexport default class AddonsPage {\n\t\n\t$addonsList: JQuery;\n\tswal: any = window['swal'];\n\t\n\tconstructor(\n\t\tprivate settings: Settings\n\t) {\n\t\t\n\t\tthis.$addonsList = $('.atum-addons');\n\t\t\n\t\tthis.$addonsList\n\t\t\n\t\t// Validate, Activate and Deactivate buttons.\n\t\t\t.on('click', '.addon-key button', (evt: JQueryEventObject) => {\n\t\t\t\n\t\t\t\tevt.preventDefault();\n\t\t\t\t\n\t\t\t\tconst $button: JQuery = $(evt.currentTarget),\n\t\t\t\t      key: string     = $button.siblings('input').val();\n\t\t\t\t\n\t\t\t\t// If no key is present, show the error directly\n\t\t\t\tif (!key) {\n\t\t\t\t\tthis.showErrorAlert( this.settings.get('invalidKey') );\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// Ask the user to confirm the deactivation\n\t\t\t\tif ($button.hasClass('deactivate-key')) {\n\t\t\t\t\t\n\t\t\t\t\tthis.swal({\n\t\t\t\t\t\ttitle            : this.settings.get('limitedDeactivations'),\n\t\t\t\t\t\thtml             : this.settings.get('allowedDeactivations'),\n\t\t\t\t\t\ttype             : 'warning',\n\t\t\t\t\t\tconfirmButtonText: this.settings.get('continue'),\n\t\t\t\t\t\tcancelButtonText : this.settings.get('cancel'),\n\t\t\t\t\t\tshowCancelButton : true\n\t\t\t\t\t}).then( () => {\n\t\t\t\t\t\tthis.requestLicenseChange($button, key);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(this.swal.noop);\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.requestLicenseChange($button, key);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t})\n\t\t\t\n\t\t\t// Install addon button.\n\t\t\t.on('click', '.install-addon', (evt: JQueryEventObject) => {\n\t\t\t\t\n\t\t\t\tconst $button: JQuery     = $(evt.currentTarget),\n\t\t\t\t      $addonBlock: JQuery = $button.closest('.theme');\n\t\t\t\t\n\t\t\t\t$.ajax({\n\t\t\t\t\turl       : window['ajaxurl'],\n\t\t\t\t\tmethod    : 'POST',\n\t\t\t\t\tdataType  : 'json',\n\t\t\t\t\tdata      : {\n\t\t\t\t\t\ttoken : this.$addonsList.data('nonce'),\n\t\t\t\t\t\taction: 'atum_install_addon',\n\t\t\t\t\t\taddon : $addonBlock.data('addon'),\n\t\t\t\t\t\tslug  : $addonBlock.data('addon-slug'),\n\t\t\t\t\t\tkey   : $addonBlock.find('.addon-key input').val()\n\t\t\t\t\t},\n\t\t\t\t\tbeforeSend: () => {\n\t\t\t\t\t\tthis.beforeAjax($button);\n\t\t\t\t\t},\n\t\t\t\t\tsuccess: (response: any) => {\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.afterAjax($button);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (response.success === true) {\n\t\t\t\t\t\t\tthis.showSuccessAlert(response.data);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tthis.showErrorAlert(response.data);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t})\n\t\t\t\n\t\t\t// Show the key fields.\n\t\t\t.on('click', '.show-key', (evt: JQueryEventObject) => {\n\t\t\t\t$(evt.currentTarget).closest('.theme').find('.addon-key').slideToggle('fast');\n\t\t\t});\n\t\t\n\t}\n\t\n\t/**\n\t * Send the Ajax request to change a license status\n\t *\n\t * @param JQuery $button\n\t * @param String key\n\t */\n\trequestLicenseChange($button: JQuery, key: string) {\n\t\t\n\t\t$.ajax({\n\t\t\turl       : window['ajaxurl'],\n\t\t\tmethod    : 'POST',\n\t\t\tdataType  : 'json',\n\t\t\tdata      : {\n\t\t\t\ttoken : this.$addonsList.data('nonce'),\n\t\t\t\taction: $button.data('action'),\n\t\t\t\taddon : $button.closest('.theme').data('addon'),\n\t\t\t\tkey   : key\n\t\t\t},\n\t\t\tbeforeSend: () => {\n\t\t\t\tthis.beforeAjax($button);\n\t\t\t},\n\t\t\tsuccess   : (response: any) => {\n\t\t\t\t\n\t\t\t\tthis.afterAjax($button);\n\t\t\t\t\n\t\t\t\tswitch (response.success) {\n\t\t\t\t\t\n\t\t\t\t\tcase false:\n\t\t\t\t\t\tthis.showErrorAlert(response.data);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\tcase true:\n\t\t\t\t\t\tthis.showSuccessAlert(response.data);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\tcase 'activate':\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.swal({\n\t\t\t\t\t\t\ttitle            : this.settings.get('activation'),\n\t\t\t\t\t\t\thtml             : response.data,\n\t\t\t\t\t\t\ttype             : 'info',\n\t\t\t\t\t\t\tshowCancelButton : true,\n\t\t\t\t\t\t\tshowLoaderOnConfirm: true,\n\t\t\t\t\t\t\tconfirmButtonText: this.settings.get('activate'),\n\t\t\t\t\t\t\tallowOutsideClick: false,\n\t\t\t\t\t\t\tpreConfirm: (): Promise<any> => {\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\treturn new Promise( (resolve: Function, reject: Function) => {\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\t\t\turl     : window['ajaxurl'],\n\t\t\t\t\t\t\t\t\t\tmethod  : 'POST',\n\t\t\t\t\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\t\t\t\t\tdata    : {\n\t\t\t\t\t\t\t\t\t\t\ttoken : this.$addonsList.data('nonce'),\n\t\t\t\t\t\t\t\t\t\t\taction: 'atum_activate_license',\n\t\t\t\t\t\t\t\t\t\t\taddon : $button.closest('.theme').data('addon'),\n\t\t\t\t\t\t\t\t\t\t\tkey   : key\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tsuccess : (response: any) => {\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tif (response.success === true) {\n\t\t\t\t\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\t\t\treject(response.data);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}).then( () => {\n\t\t\t\t\t\t\tthis.showSuccessAlert( this.settings.get('addonActivated'), this.settings.get('activated') );\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(this.swal.noop);\n\t\t\t\t\t\t\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t});\n\t\t\n\t}\n\t\n\t/**\n\t * Show a success alert\n\t *\n\t * @param string message\n\t * @param string title\n\t */\n\tshowSuccessAlert(message: string, title?: string) {\n\t\t\n\t\tif (!title) {\n\t\t\ttitle = this.settings.get('success');\n\t\t}\n\t\t\n\t\tthis.swal({\n\t\t\ttitle            : title,\n\t\t\thtml             : message,\n\t\t\ttype             : 'success',\n\t\t\tconfirmButtonText: this.settings.get('ok')\n\t\t}).then( () => {\n\t\t\tlocation.reload();\n\t\t});\n\t\t\n\t}\n\t\n\t/**\n\t * Default error message\n\t *\n\t * @param string message\n\t */\n\tshowErrorAlert(message: string) {\n\t\t\n\t\tthis.swal({\n\t\t\ttitle            : this.settings.get('error'),\n\t\t\thtml             : message,\n\t\t\ttype             : 'error',\n\t\t\tconfirmButtonText: this.settings.get('ok')\n\t\t});\n\t\t\n\t}\n\t\n\t/**\n\t * Actions before an ajax request\n\t *\n\t * @param JQuery $button\n\t */\n\tbeforeAjax($button: JQuery) {\n\t\t\n\t\t$('.theme').find('.button').prop('disabled', true);\n\t\t$button.css('visibility', 'hidden').after('<div class=\"atum-loading\"></div>');\n\t\t\n\t}\n\t\n\t/**\n\t * Actions after an ajax request\n\t *\n\t * @param JQuery $button\n\t */\n\tafterAjax($button: JQuery) {\n\t\t\n\t\t$('.atum-loading').remove();\n\t\t$('.theme').find('.button').prop('disabled', false);\n\t\t$button.css('visibility', 'visible');\n\t\t\n\t}\n\t\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/src/components/addons-page/_addons-page.ts"],"sourceRoot":""}