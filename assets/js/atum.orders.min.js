!function(l){"use strict";l(function(){var a={init:function(){this.$container=l("#atum_order_items"),this.$itemsBlocker=this.$container.find(".items-blocker"),this.areItemsSelectable=atumOrder.enableSelectItems,this.stupidtable.init(),this.isEditable=l("#atum_order_is_editable").val(),this.askRemoval=!0;var t=this;this.$container.on("click","button.add-line-item",this.add_line_item).on("click",".cancel-action",this.cancel).on("click","button.add-atum-order-item",this.add_item).on("click","button.add-atum-order-fee",this.add_fee).on("click","button.add-atum-order-shipping",this.add_shipping).on("click","button.add-atum-order-tax",this.add_tax).on("click","button.save-action",this.save_line_items).on("click","a.delete-atum-order-tax",this.delete_tax).on("click","button.calculate-action",this.recalculate).on("click","a.edit-atum-order-item",this.edit_item).on("click","a.delete-atum-order-item",this.delete_item).on("click","button.bulk-delete-items",this.do_bulk_delete).on("click","button.bulk-increase-stock",this.do_bulk_increase_stock).on("click","button.bulk-decrease-stock",this.do_bulk_decrease_stock).on("change","input.quantity",this.quantity_changed).on("keyup change",".split-input :input",function(){var t=l(this).parent().prev().find(":input");t&&(""===t.val()||t.is(".match-total"))&&t.val(l(this).val()).addClass("match-total")}).on("keyup",".split-input :input",function(){l(this).removeClass("match-total")}).on("click","button.add-atum-order-item-meta",this.item_meta.add).on("click","button.remove-atum-order-item-meta",this.item_meta.remove).on("click","button.set-purchase-price",this.item_meta.set_purchase_price),this.areItemsSelectable&&this.$container.on("click","tr.item, tr.fee, tr.shipping",this.select_row).on("click","tr.item :input, tr.fee :input, tr.shipping :input, tr.item a, tr.fee a, tr.shipping a",this.select_row_child),l(document.body).on("wc_backbone_modal_loaded",this.backbone.init).on("wc_backbone_modal_response",this.backbone.response),l("#atum_order_type").change(this.toggleExtraFields).change(),l("#multiple_suppliers").change(function(){t.toggleSupplierField(l(this))}).change(),l(".dropdown_supplier").change(function(){l(this).val()?t.$itemsBlocker.addClass("unblocked"):t.$itemsBlocker.removeClass("unblocked")}).change(),l("#wc_order").change(this.importOrderItems),l(".wp-heading-inline").append(l(".page-title-action")),l(".page-title-action").show(),l(window).on("load",function(){l(".footer-box").hasClass("no-style")&&(l("#wpfooter").css("position","relative").show(),l("#wpcontent").css("min-height","95vh"))}),this.addAtumSelectClasses(),l("body").on("wc-enhanced-select-init",this.addAtumSelectClasses)},block:function(){this.$container.block({message:null,overlayCSS:{background:"#000",opacity:.5}})},unblock:function(){this.$container.unblock()},reload_items:function(t){this.load_items_table({atum_order_id:atumOrder.post_id,action:"atum_order_load_items",security:atumOrder.atum_order_item_nonce},"html",t)},load_items_table:function(t,i,o){var n=this;this.block(),i=void 0!==i?i:"html",l.ajax({url:ajaxurl,data:t,dataType:i,method:"POST",success:function(t){if("object"==typeof t&&!0===t.success||"object"!=typeof t){var e="html"===i?t:t.data.html;n.$container.find(".inside").empty().append(e),n.reloadTooltips(),n.stupidtable.init()}else"object"==typeof t&&!1===t.success&&n.showalert("error",atumOrder.error,t.data.error);n.unblock(),void 0!==o&&o()}})},quantity_changed:function(){var r=l(this).closest("tr.item"),a=l(this).val(),s=l(this).data("qty"),t=l("input.line_total",r),e=l("input.line_subtotal",r),i=accounting.unformat(t.data("total"),atumOrder.mon_decimal_point)/s;t.val(parseFloat(accounting.formatNumber(i*a,atumOrder.rounding_precision,"")).toString().replace(".",atumOrder.mon_decimal_point));var o=accounting.unformat(e.data("subtotal"),atumOrder.mon_decimal_point)/s;e.val(parseFloat(accounting.formatNumber(o*a,atumOrder.rounding_precision,"")).toString().replace(".",atumOrder.mon_decimal_point)),l("input.line_tax",r).each(function(){var t=l(this),e=t.data("tax_id"),i=accounting.unformat(t.data("total_tax"),atumOrder.mon_decimal_point)/s,o=l('input.line_subtotal_tax[data-tax_id="'+e+'"]',r),n=accounting.unformat(o.data("subtotal_tax"),atumOrder.mon_decimal_point)/s;0<i&&t.val(parseFloat(accounting.formatNumber(i*a,atumOrder.rounding_precision,"")).toString().replace(".",atumOrder.mon_decimal_point)),0<n&&o.val(parseFloat(accounting.formatNumber(n*a,atumOrder.rounding_precision,"")).toString().replace(".",atumOrder.mon_decimal_point))}),l(this).trigger("quantity_changed")},add_line_item:function(){return l("div.atum-order-add-item").slideDown(),l("div.atum-order-data-row-toggle").not("div.atum-order-add-item").slideUp(),!1},cancel:function(){return l("div.atum-order-data-row-toggle").not("div.atum-order-bulk-actions").slideUp(),l("div.atum-order-bulk-actions, div.atum-order-totals-items").slideDown(),l(".atum-order-edit-line-item .atum-order-edit-line-item-actions").show(),"true"===l(this).data("reload")&&a.reload_items(),!1},add_item:function(){return l(this).WCBackboneModal({template:"atum-modal-add-products"}),!1},add_fee:function(){a.block();var t={action:"atum_order_add_fee",atum_order_id:atumOrder.post_id,security:atumOrder.atum_order_item_nonce};return l.post(ajaxurl,t,function(t){t.success?l("#atum_order_fee_line_items").append(t.data.html):this.showalert("error",atumOrder.error,t.data.error),a.unblock()},"json"),!1},add_shipping:function(){a.block();var t={action:"atum_order_add_shipping",atum_order_id:atumOrder.post_id,security:atumOrder.atum_order_item_nonce};return l.post(ajaxurl,t,function(t){t.success?l("#atum_order_shipping_line_items").append(t.data.html):this.showalert("error",atumOrder.error,t.data.error),a.unblock()},"json"),!1},add_tax:function(){return l(this).WCBackboneModal({template:"atum-modal-add-tax"}),!1},edit_item:function(){var t=l(this);return t.closest("tr").find(".view").hide(),t.closest("tr").find(".edit").show(),t.hide(),l("button.add-line-item").click(),l("button.cancel-action").data("reload",!0),!1},delete_item:function(){var t=l(this).closest("tr.item, tr.fee, tr.shipping"),i=t.data("atum_order_item_id"),e=t.closest("#atum_order_items");return swal({text:atumOrder.remove_item_notice,type:"warning",showCancelButton:!0,confirmButtonText:atumOrder.continue,cancelButtonText:atumOrder.cancel,reverseButtons:!0,allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(t,e){a.block(),l.ajax({url:ajaxurl,data:{atum_order_id:atumOrder.post_id,atum_order_item_ids:i,action:"atum_order_remove_item",security:atumOrder.atum_order_item_nonce},type:"POST",success:function(){t()}})})}}).then(function(){t.remove(),e.trigger("atum_item_line_removed",[i]),a.unblock()}).catch(swal.noop),!1},delete_tax:function(){return swal({text:atumOrder.delete_tax_notice,type:"warning",showCancelButton:!0,confirmButtonText:atumOrder.continue,cancelButtonText:atumOrder.cancel,reverseButtons:!0,allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(t,e){a.load_items_table({action:"atum_order_remove_tax",rate_id:l(this).data("rate_id"),atum_order_id:atumOrder.post_id,security:atumOrder.atum_order_item_nonce},"html",t)})}}).catch(swal.noop),!1},recalculate:function(){return swal({text:atumOrder.calc_totals,type:"warning",showCancelButton:!0,confirmButtonText:atumOrder.continue,cancelButtonText:atumOrder.cancel,reverseButtons:!0,allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(t,e){a.load_items_table({action:"atum_order_calc_line_taxes",atum_order_id:atumOrder.post_id,items:l("table.atum_order_items :input[name], .atum-order-totals-items :input[name]").serialize(),security:atumOrder.calc_totals_nonce},"html",t)})}}).catch(swal.noop),!1},save_line_items:function(){return a.load_items_table({atum_order_id:atumOrder.post_id,items:l("table.atum_order_items :input[name], .atum-order-totals-items :input[name]").serialize(),action:"atum_order_save_items",security:atumOrder.atum_order_item_nonce}),l(this).trigger("items_saved"),!1},item_meta:{add:function(){var t=l(this).closest("tr.item, tr.shipping"),e=t.find("tbody.meta_items"),i=e.find("tr").length+1,o='<tr data-meta_id="0"><td><input type="text" placeholder="'+atumOrder.placeholder_name+'" name="meta_key['+t.data("atum_order_item_id")+"][new-"+i+']" /><textarea placeholder="'+atumOrder.placeholder_value+'" name="meta_value['+t.data("atum_order_item_id")+"][new-"+i+']"></textarea></td><td width="1%"><button class="remove-atum-order-item-meta button">&times;</button></td></tr>';return e.append(o),!1},remove:function(){return swal({text:atumOrder.remove_item_meta,type:"warning",showCancelButton:!0,confirmButtonText:atumOrder.continue,cancelButtonText:atumOrder.cancel,reverseButtons:!0,allowOutsideClick:!1,preConfirm:function(){return new Promise(function(t,e){var i=l(this).closest("tr");i.find(":input").val(""),i.hide(),t()})}}).catch(swal.noop),!1},set_purchase_price:function(t){var e=l(t.target).closest(".item"),i=parseFloat(e.find("input.quantity").val()||1),o=0!==i?accounting.unformat(e.find("input.line_total").val()||0,atumOrder.mon_decimal_point)/i:0,n={atum_order_id:atumOrder.post_id,atum_order_item_id:e.data("atum_order_item_id"),action:"atum_order_change_purchase_price",security:atumOrder.atum_order_item_nonce};n[atumOrder.purchase_price_field]=o,swal({html:atumOrder.confirm_purchase_price.replace("{{number}}","<strong>"+o+"</strong>"),type:"question",showCancelButton:!0,confirmButtonText:atumOrder.continue,cancelButtonText:atumOrder.cancel,reverseButtons:!0,allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(e,i){l.ajax({url:ajaxurl,data:n,type:"POST",dataType:"json",success:function(t){!1===t.success?i(t.data):e()}})})}}).then(function(){swal({title:atumOrder.done,text:atumOrder.purchase_price_changed,type:"success",confirmButtonText:atumOrder.ok})}).catch(swal.noop)}},select_row:function(){var t=l(this).is("tr")?l(this):l(this).closest("tr"),e=l(this).closest("table");t.is(".selected")?t.removeClass("selected"):t.addClass("selected");var i=e.find("tr.selected"),o=l("div.atum-order-item-bulk-edit");if(i.length){var n=l(".bulk-decrease-stock, .bulk-increase-stock");l("table.atum_order_items").find("tr.item.selected").length?n.show():n.hide(),o.slideDown();i.each(function(){l(this).is("tr.item")&&!0})}else o.slideUp()},select_row_child:function(t){t.stopPropagation()},do_bulk_delete:function(t){void 0!==t&&t.preventDefault();var i=l("table.atum_order_items").find("tr.selected"),o=[];i.length&&(!0===a.askRemoval?swal({text:atumOrder.remove_item_notice,type:"warning",showCancelButton:!0,confirmButtonText:atumOrder.continue,cancelButtonText:atumOrder.cancel,reverseButtons:!0,allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(t,e){(o=a.bulk_delete_items(i)).length?l.when.apply(l,o).done(function(){a.reload_items(),t()}):t()})}}).catch(swal.noop):(o=a.bulk_delete_items(i),a.askRemoval=!0,o.length&&l.when.apply(l,o).done(function(){a.reload_items(function(){swal.close()})})))},bulk_delete_items:function(t){a.block();var e=[],i=[];return l.map(t,function(t){e.push(parseInt(l(t).data("atum_order_item_id"),10))}),e.length&&i.push(l.ajax({url:ajaxurl,data:{atum_order_id:atumOrder.post_id,atum_order_item_ids:e,action:"atum_order_remove_item",security:atumOrder.atum_order_item_nonce},type:"POST"})),i},do_bulk_increase_stock:function(t){t.preventDefault(),a.bulk_change_stock("increase")},do_bulk_decrease_stock:function(t){t.preventDefault(),a.bulk_change_stock("decrease")},bulk_change_stock:function(r){a.block(),swal({title:atumOrder.are_you_sure,text:"increase"===r?atumOrder.increase_stock_msg:atumOrder.decrease_stock_msg,type:"warning",showCancelButton:!0,confirmButtonText:atumOrder.continue,cancelButtonText:atumOrder.cancel,reverseButtons:!0,allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(e,i){var t=l("table.atum_order_items").find("tr.selected"),o={},n=l.map(t,function(t){return parseInt(l(t).data("atum_order_item_id"),10)});t.each(function(){l(this).find("input.quantity").length&&(o[l(this).data("atum_order_item_id")]=l(this).find("input.quantity").val())}),l.ajax({url:ajaxurl,data:{atum_order_id:atumOrder.post_id,atum_order_item_ids:n,quantities:o,action:"atum_order_"+r+"_items_stock",security:atumOrder.atum_order_item_nonce},method:"POST",dataType:"json",success:function(t){!0===t.success?e():i(t.data)}})})}}).then(function(){swal({title:atumOrder.done,text:"increase"===r?atumOrder.stock_increased:atumOrder.stock_decreased,type:"success",confirmButtonText:atumOrder.ok}),a.unblock()},function(t){a.unblock()})},backbone:{init:function(t,e){"atum-modal-add-products"===e&&l(document.body).trigger("wc-enhanced-select-init")},response:function(t,e,i){if("atum-modal-add-tax"===e){var o=i.add_atum_order_tax,n="";i.manual_tax_rate_id&&(n=i.manual_tax_rate_id),a.backbone.add_tax(o,n)}"atum-modal-add-products"===e&&a.backbone.add_item(i.add_atum_order_items)},add_item:function(t){if(t){a.block();var e={action:"atum_order_add_item",item_to_add:t,atum_order_id:atumOrder.post_id,security:atumOrder.atum_order_item_nonce};l.post(ajaxurl,e,function(t){t.success?l("#atum_order_line_items").append(t.data.html):this.showalert("error",atumOrder.error,t.data.error),a.reloadTooltips(),a.unblock()},"json")}},add_tax:function(t,e){if(e&&(t=e),!t)return!1;var i=l(".atum-order-tax-id").map(function(){return l(this).val()}).get();-1===l.inArray(t,i)?a.load_items_table({action:"atum_order_add_tax",rate_id:t,atum_order_id:atumOrder.post_id,security:atumOrder.atum_order_item_nonce},"json"):this.showalert("error",atumOrder.error,atumOrder.tax_rate_already_exists)}},stupidtable:{init:function(){l("table.atum_order_items").stupidtable(),l("table.atum_order_items").on("aftertablesort",this.add_arrows)},add_arrows:function(t,e){var i=l(this).find("th"),o="asc"===e.direction?"&uarr;":"&darr;",n=e.column;i.find(".atum-arrow").remove(),i.eq(n).append('<span class="atum-arrow">'+o+"</span>")}},reloadTooltips:function(){this.$container.find('[data-toggle="tooltip"]').tooltip({container:"body"})},toggleExtraFields:function(){var e=l(this),i=e.val();l("[data-dependency]").each(function(){var t=l(this).data("dependency").split(":");t[0]===e.attr("id")&&(t[1]===i?l(this).fadeIn():l(this).is(":visible")&&l(this).hide())})},toggleSupplierField:function(t){var e=l("body"),i=l(".dropdown_supplier"),o=i.parent();t.is(":checked")?(i.val("").change(),e.addClass("allow-multiple-suppliers"),this.$itemsBlocker.addClass("unblocked"),o.slideUp()):(e.removeClass("allow-multiple-suppliers"),this.$itemsBlocker.removeClass("unblocked"),o.slideDown())},importOrderItems:function(){var i=l("#wc_order").val();if(!i||"false"==a.isEditable)return!1;swal({text:atumOrder.import_order_items,type:"warning",showCancelButton:!0,confirmButtonText:atumOrder.continue,cancelButtonText:atumOrder.cancel,reverseButtons:!0,allowOutsideClick:!1,preConfirm:function(){return new Promise(function(t,e){a.load_items_table({action:"atum_order_import_items",wc_order_id:i,atum_order_id:atumOrder.post_id,security:atumOrder.import_order_items_nonce},"json",t)})}}).catch(swal.noop)},showalert:function(t,e,i){swal({title:e,text:i,type:t,confirmButtonText:atumOrder.ok})},addAtumSelectClasses:function(){l("select").filter(".atum-select2, .atum-enhanced-select").each(function(){var t=l(this),e=t.siblings(".select2-container").not(".atum-select2, .atum-enhanced-select");e.length&&e.addClass(t.hasClass("atum-select2")?"atum-select2":"atum-enhanced-select")})}};({init:function(){var t=this;this.$container=l("#atum_order_notes"),this.$textarea=l("textarea#add_atum_order_note"),this.$container.on("click","button.add_note",function(){t.add_note()}).on("click","a.delete_note",function(){t.delete_note(l(this))})},add_note:function(){if(this.$textarea.val()){this.$container.block({message:null,overlayCSS:{background:"#000",opacity:.5}});var t={action:"atum_order_add_note",post_id:l("#post_ID").val(),note:this.$textarea.val(),security:atumOrder.add_note_nonce},e=this;return l.post(ajaxurl,t,function(t){l("ul.atum_order_notes").prepend(t),e.$container.unblock(),e.$textarea.val("")}),!1}},delete_note:function(t){var o=t.closest("li.note");return swal({text:atumOrder.delete_note,type:"warning",showCancelButton:!0,confirmButtonText:atumOrder.continue,cancelButtonText:atumOrder.cancel,reverseButtons:!0,allowOutsideClick:!1,preConfirm:function(){return new Promise(function(t,e){o.block({message:null,overlayCSS:{background:"#000",opacity:.5}});var i={action:"atum_order_delete_note",note_id:o.attr("rel"),security:atumOrder.delete_note_nonce};l.post(ajaxurl,i,function(){t()})})}}).then(function(){o.remove()}).catch(swal.noop),!1}}).init(),a.init(),l('[data-toggle="tooltip"]').tooltip({container:"body"}),l(".date-picker").datepicker({dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:!0}),l(".js-switch").each(function(){new Switchery(this,{size:"small",color:"#d5f5ba",secondaryColor:"#e9ecef",jackColor:"#69c61d",jackSecondaryColor:"#adb5bd"})})})}(jQuery),jQuery.noConflict(),void 0===jQuery.fn.tooltip&&(function(t){"use strict";var e=jQuery.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1==e[0]&&9==e[1]&&e[2]<1||3<e[0])throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(),function(_){"use strict";var f=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)};f.VERSION="3.3.7",f.TRANSITION_DURATION=150,f.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},f.prototype.init=function(t,e,i){if(this.enabled=!0,this.type=t,this.$element=_(e),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&_(_.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var o=this.options.trigger.split(" "),n=o.length;n--;){var r=o[n];if("click"==r)this.$element.on("click."+this.type,this.options.selector,_.proxy(this.toggle,this));else if("manual"!=r){var a="hover"==r?"mouseenter":"focusin",s="hover"==r?"mouseleave":"focusout";this.$element.on(a+"."+this.type,this.options.selector,_.proxy(this.enter,this)),this.$element.on(s+"."+this.type,this.options.selector,_.proxy(this.leave,this))}}this.options.selector?this._options=_.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},f.prototype.getDefaults=function(){return f.DEFAULTS},f.prototype.getOptions=function(t){return(t=_.extend({},this.getDefaults(),this.$element.data(),t)).delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},f.prototype.getDelegateOptions=function(){var i={},o=this.getDefaults();return this._options&&_.each(this._options,function(t,e){o[t]!=e&&(i[t]=e)}),i},f.prototype.enter=function(t){var e=t instanceof this.constructor?t:_(t.currentTarget).data("bs."+this.type);return e||(e=new this.constructor(t.currentTarget,this.getDelegateOptions()),_(t.currentTarget).data("bs."+this.type,e)),t instanceof _.Event&&(e.inState["focusin"==t.type?"focus":"hover"]=!0),e.tip().hasClass("in")||"in"==e.hoverState?void(e.hoverState="in"):(clearTimeout(e.timeout),e.hoverState="in",e.options.delay&&e.options.delay.show?void(e.timeout=setTimeout(function(){"in"==e.hoverState&&e.show()},e.options.delay.show)):e.show())},f.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},f.prototype.leave=function(t){var e=t instanceof this.constructor?t:_(t.currentTarget).data("bs."+this.type);return e||(e=new this.constructor(t.currentTarget,this.getDelegateOptions()),_(t.currentTarget).data("bs."+this.type,e)),t instanceof _.Event&&(e.inState["focusout"==t.type?"focus":"hover"]=!1),e.isInStateTrue()?void 0:(clearTimeout(e.timeout),e.hoverState="out",e.options.delay&&e.options.delay.hide?void(e.timeout=setTimeout(function(){"out"==e.hoverState&&e.hide()},e.options.delay.hide)):e.hide())},f.prototype.show=function(){var t=_.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);var e=_.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(t.isDefaultPrevented()||!e)return;var i=this,o=this.tip(),n=this.getUID(this.type);this.setContent(),o.attr("id",n),this.$element.attr("aria-describedby",n),this.options.animation&&o.addClass("fade");var r="function"==typeof this.options.placement?this.options.placement.call(this,o[0],this.$element[0]):this.options.placement,a=/\s?auto?\s?/i,s=a.test(r);s&&(r=r.replace(a,"")||"top"),o.detach().css({top:0,left:0,display:"block"}).addClass(r).data("bs."+this.type,this),this.options.container?o.appendTo(this.options.container):o.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var l=this.getPosition(),d=o[0].offsetWidth,u=o[0].offsetHeight;if(s){var c=r,m=this.getPosition(this.$viewport);r="bottom"==r&&l.bottom+u>m.bottom?"top":"top"==r&&l.top-u<m.top?"bottom":"right"==r&&l.right+d>m.width?"left":"left"==r&&l.left-d<m.left?"right":r,o.removeClass(c).addClass(r)}var p=this.getCalculatedOffset(r,l,d,u);this.applyPlacement(p,r);var h=function(){var t=i.hoverState;i.$element.trigger("shown.bs."+i.type),i.hoverState=null,"out"==t&&i.leave(i)};_.support.transition&&this.$tip.hasClass("fade")?o.one("bsTransitionEnd",h).emulateTransitionEnd(f.TRANSITION_DURATION):h()}},f.prototype.applyPlacement=function(t,e){var i=this.tip(),o=i[0].offsetWidth,n=i[0].offsetHeight,r=parseInt(i.css("margin-top"),10),a=parseInt(i.css("margin-left"),10);isNaN(r)&&(r=0),isNaN(a)&&(a=0),t.top+=r,t.left+=a,_.offset.setOffset(i[0],_.extend({using:function(t){i.css({top:Math.round(t.top),left:Math.round(t.left)})}},t),0),i.addClass("in");var s=i[0].offsetWidth,l=i[0].offsetHeight;"top"==e&&l!=n&&(t.top=t.top+n-l);var d=this.getViewportAdjustedDelta(e,t,s,l);d.left?t.left+=d.left:t.top+=d.top;var u=/top|bottom/.test(e),c=u?2*d.left-o+s:2*d.top-n+l,m=u?"offsetWidth":"offsetHeight";i.offset(t),this.replaceArrow(c,i[0][m],u)},f.prototype.replaceArrow=function(t,e,i){this.arrow().css(i?"left":"top",50*(1-t/e)+"%").css(i?"top":"left","")},f.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},f.prototype.hide=function(t){function e(){"in"!=i.hoverState&&o.detach(),i.$element&&i.$element.removeAttr("aria-describedby").trigger("hidden.bs."+i.type),t&&t()}var i=this,o=_(this.$tip),n=_.Event("hide.bs."+this.type);return this.$element.trigger(n),n.isDefaultPrevented()?void 0:(o.removeClass("in"),_.support.transition&&o.hasClass("fade")?o.one("bsTransitionEnd",e).emulateTransitionEnd(f.TRANSITION_DURATION):e(),this.hoverState=null,this)},f.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},f.prototype.hasContent=function(){return this.getTitle()},f.prototype.getPosition=function(t){var e=(t=t||this.$element)[0],i="BODY"==e.tagName,o=e.getBoundingClientRect();null==o.width&&(o=_.extend({},o,{width:o.right-o.left,height:o.bottom-o.top}));var n=window.SVGElement&&e instanceof window.SVGElement,r=i?{top:0,left:0}:n?null:t.offset(),a={scroll:i?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},s=i?{width:_(window).width(),height:_(window).height()}:null;return _.extend({},o,a,s,r)},f.prototype.getCalculatedOffset=function(t,e,i,o){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-o,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-o/2,left:e.left-i}:{top:e.top+e.height/2-o/2,left:e.left+e.width}},f.prototype.getViewportAdjustedDelta=function(t,e,i,o){var n={top:0,left:0};if(!this.$viewport)return n;var r=this.options.viewport&&this.options.viewport.padding||0,a=this.getPosition(this.$viewport);if(/right|left/.test(t)){var s=e.top-r-a.scroll,l=e.top+r-a.scroll+o;s<a.top?n.top=a.top-s:l>a.top+a.height&&(n.top=a.top+a.height-l)}else{var d=e.left-r,u=e.left+r+i;d<a.left?n.left=a.left-d:u>a.right&&(n.left=a.left+a.width-u)}return n},f.prototype.getTitle=function(){var t=this.$element,e=this.options;return t.attr("data-original-title")||("function"==typeof e.title?e.title.call(t[0]):e.title)},f.prototype.getUID=function(t){for(;t+=~~(1e6*Math.random()),document.getElementById(t););return t},f.prototype.tip=function(){if(!this.$tip&&(this.$tip=_(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},f.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},f.prototype.enable=function(){this.enabled=!0},f.prototype.disable=function(){this.enabled=!1},f.prototype.toggleEnabled=function(){this.enabled=!this.enabled},f.prototype.toggle=function(t){var e=this;t&&((e=_(t.currentTarget).data("bs."+this.type))||(e=new this.constructor(t.currentTarget,this.getDelegateOptions()),_(t.currentTarget).data("bs."+this.type,e))),t?(e.inState.click=!e.inState.click,e.isInStateTrue()?e.enter(e):e.leave(e)):e.tip().hasClass("in")?e.leave(e):e.enter(e)},f.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null,t.$element=null})};var t=_.fn.tooltip;_.fn.tooltip=function(o){return this.each(function(){var t=_(this),e=t.data("bs.tooltip"),i="object"==typeof o&&o;!e&&/destroy|hide/.test(o)||(e||t.data("bs.tooltip",e=new f(this,i)),"string"==typeof o&&e[o]())})},_.fn.tooltip.Constructor=f,_.fn.tooltip.noConflict=function(){return _.fn.tooltip=t,this}}(jQuery),function(o){"use strict";o.fn.emulateTransitionEnd=function(t){var e=!1,i=this;o(this).one("bsTransitionEnd",function(){e=!0});return setTimeout(function(){e||o(i).trigger(o.support.transition.end)},t),this},o(function(){o.support.transition=function(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in e)if(void 0!==t.style[i])return{end:e[i]};return!1}(),o.support.transition&&(o.event.special.bsTransitionEnd={bindType:o.support.transition.end,delegateType:o.support.transition.end,handle:function(t){return o(t.target).is(this)?t.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery));