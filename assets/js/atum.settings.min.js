(function($,window,document,undefined){"use strict";var pluginName="atumSettings",defaults={};function Plugin(element,options){this.$settingsWrapper=$(element);this.$nav=this.$settingsWrapper.find(".atum-nav");this.$form=this.$settingsWrapper.find("#atum-settings");this.settings=$.extend({},defaults,atumSettingsVars||{},options||{});this._defaults=defaults;this._name=pluginName;this.init()}$.extend(Plugin.prototype,{navigationReady:false,numHashParameters:0,init:function(){var self=this;this.setupNavigation();this.doSwitchers();this.restoreEnhancedSelects();this.$form.on("change","input, select, textarea",function(){$(this).addClass("dirty")}).on("click","input[type=submit]",function(){self.$form.find(".dirty").removeClass("dirty")}).on("change","#atum_same_ship_address",function(){var $shippingSection=$("#atum_setting_shipping");if(this.checked){$shippingSection.slideUp()}else{$shippingSection.slideDown()}}).find("#atum_same_ship_address").change();$(window).bind("beforeunload",function(){if(!self.$form.find(".dirty").length){return}if(navigator.userAgent.toLowerCase().match(/msie|chrome/)){if(window.aysHasPrompted){return}window.aysHasPrompted=true;window.setTimeout(function(){window.aysHasPrompted=false},900)}return false})},doSwitchers:function(){$(".js-switch").each(function(){new Switchery(this,{size:"small"})})},restoreEnhancedSelects:function(){$(".select2-container--open").remove();$("body").trigger("wc-enhanced-select-init")},setupNavigation:function(){if(typeof $.address==="undefined"){return}var self=this;$.address.change(function(event){var pathNames=$.address.pathNames(),numCurrentParams=pathNames.length;if(self.navigationReady===true&&(numCurrentParams||self.numHashParameters!==numCurrentParams)){self.clickTab(pathNames[0])}self.navigationReady=true}).init(function(){var pathNames=$.address.pathNames();if(pathNames.length){self.clickTab(pathNames[0])}})},clickTab:function(tab){var self=this,$navLink=this.$nav.find('.atum-nav-link[data-tab="'+tab+'"]');if(this.$form.find(".dirty").length){swal({title:this.settings.areYouSure,text:this.settings.unsavedData,type:"warning",showCancelButton:true,confirmButtonText:this.settings.continue,cancelButtonText:this.settings.cancel,reverseButtons:true,allowOutsideClick:false}).then(function(){self.moveToTab($navLink)},function(dismiss){$navLink.blur()})}else{self.moveToTab($navLink)}},moveToTab:function($navLink){var self=this,$formSettingsWrapper=this.$form.find(".form-settings-wrapper");this.$nav.find(".atum-nav-link.active").not($navLink).removeClass("active");$navLink.addClass("active");$formSettingsWrapper.addClass("overlay");this.$form.load($navLink.attr("href")+" .form-settings-wrapper",function(){self.doSwitchers();self.restoreEnhancedSelects();self.$form.find("#atum_same_ship_address").change();var $inputButton=self.$form.find("input:submit");if($navLink.parent().hasClass("no-submit")){$inputButton.hide()}else{$inputButton.show()}})}});$.fn[pluginName]=function(options){return this.each(function(){if(!$.data(this,"plugin_"+pluginName)){$.data(this,"plugin_"+pluginName,new Plugin(this,options))}})};$(function(){$(".atum-settings-wrapper").atumSettings()})})(jQuery,window,document);